{
  "hash": "bee7c5d7277afc1f4068970dcde73ccd",
  "result": {
    "markdown": "---\ntitle: \"Data Visualization\"\nauthor: \"Arash Amiririgi\"\n---\n\n\n::: callout-note\nCOVID-19 number of cases in analysed and visualized here.\n:::\n\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-1_43a6eee347a9516ca5dc2f7590db69cb'}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(dplyr, warn.conflicts = FALSE)\nlibrary(ggplot2)\nlibrary(scales)\nlibrary(lubridate)\nlibrary(ggthemes)\nlibrary(RColorBrewer)\nlibrary(viridisLite)\n\ncovid_data_tbl <- read_csv(\"https://covid.ourworldindata.org/data/owid-covid-data.csv\", col_types = cols())\n```\n:::\n\n\n## Challenge:\n### Time course of the cumulative Covid-19 cases!\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-2_b185cf192b1c7e0a20dabd5055ae2d41'}\n\n```{.r .cell-code}\n## data manipulation for desired coutries ----\ncovid_cases_country <- covid_data_tbl %>%\n  select(location, date, new_cases) %>%\n  mutate(new_cases = replace_na(new_cases, 0))\n\ncovid_cases_country <- covid_cases_country %>%\n  filter(location == \"Germany\" | location == \"France\" |location == \"Spain\" |\n           location == \"United Kingdom\" |\n           location == \"United States\") %>%\n  filter(date <= '2022-04-19')\n\ncovid_cases_country <- covid_cases_country %>%\n  group_by(location) %>% mutate(cum_sum = cumsum(new_cases)) %>%\n  ungroup()\n\ncovid_cases_country <- covid_cases_country %>% select(1:2, 4) %>%\n  set_names(c('location', 'date', 'cumulative_cases'))\n\n## data manipulation for Europe ----\ncovid_cases_Europe <- covid_data_tbl %>%\n  select(continent, location, date, new_cases) %>%\n  mutate(new_cases = replace_na(new_cases, 0))\n\ncovid_cases_Europe <- covid_cases_Europe %>%\n  filter(continent == 'Europe') %>%\n  filter(date <= '2022-04-19')\n\noptions(dplyr.summarise.inform = FALSE)\ncovid_cases_Europe <- covid_cases_Europe %>%\n  group_by(continent, date) %>% summarise(new_cases = sum(new_cases)) %>%\n  ungroup()\n\ncovid_cases_Europe <- covid_cases_Europe %>% \n  mutate(cum_sum = cumsum(new_cases))\n\ncovid_cases_Europe <- covid_cases_Europe %>% select(1:2, 4) %>%\n  set_names(c('location', 'date', 'cumulative_cases'))\n\n## data combination ----\ncumulative_cases <- bind_rows(covid_cases_country, covid_cases_Europe)\n\n## ggplot ----\n#cumulative_cases %>% ggplot()\ncumulative_cases %>% ggplot(aes(date, cumulative_cases, color = location)) +\n  geom_line() +\n  scale_color_brewer(palette = \"Spectral\") +\n  scale_y_continuous(labels = dollar_format(scale = 1e-6,\n                                            prefix = \"\", suffix = \" M\")) +\n  geom_label(aes(label =  dollar(cumulative_cases, big.mark = '.',\n                                 decimal.mark = ',', prefix = '', suffix = '')),\n             vjust = 1, hjust = 1.3, size  = 3,\n             fill  = \"red\",color = \"white\",\n             data = cumulative_cases %>% slice(n())) +\n  geom_label(aes(label =  dollar(cumulative_cases, big.mark = '.',\n                                 decimal.mark = ',', prefix = '', suffix = '')),\n             vjust = -0.2, hjust = 1.2, size  = 3,\n             fill  = \"blue\",color = \"white\",\n             data = cumulative_cases %>% slice(4190)) +\n  labs(title = \"COVID-19 confirmed cases worldwide\",\n       subtitle = \"As of 19/04/2022\",\n       x = \"\", y = \"Cumulative Cases\",\n       color = \"Continent / Country\") +\n  theme_light() +\n  theme(legend.position = \"bottom\", \n        plot.title = element_text(face = 'bold')) +\n  theme(axis.title = element_text(face = \"bold\")) +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 6)) +\n  scale_x_date(date_breaks = \"1 month\", date_labels = \"%B %y\") +\n  expand_limits(x = c(as.Date('2020-01-01', format = \"%Y-%m-%d\"),\n                      as.Date('2022-04-01', format = \"%Y-%m-%d\")))\n```\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n## Challenge:\n### Visualization of the distribution of the mortality rate.\n\n::: {.cell hash='04_data_visualization_cache/html/unnamed-chunk-3_c4fcb91a6efb05448b775e1cd03db98c'}\n\n```{.r .cell-code}\n## data manipulation ----\nworld <- map_data(\"world\") \n\nmortality_rate <- covid_data_tbl %>% filter(date <= '2022-04-16') %>%\n  select(continent, location, total_deaths, population) %>%\n  filter(!(is.na(continent))) %>% select(2:4)\nsuppressWarnings(deaths_ratio <- mortality_rate %>% group_by(location) %>%\n  reframe(deaths_per_population = max(total_deaths, na.rm = T) / population) %>%\n  group_by(location) %>% slice(1) %>% ungroup() %>%\n  set_names(c('country', 'deaths_per_population')) %>%\n  as.data.frame)\n\ntotal_death <- round(sum((covid_data_tbl %>% filter(date <= '2022-04-16' & !(is.na(continent))) %>%\n  mutate(new_deaths = replace_na(new_deaths, 0)))$new_deaths) / 1e6, digits = 1)\n                                                            \ndeaths_ratio['deaths_per_population'][deaths_ratio['deaths_per_population'] == -Inf] <- NA\ndeaths_ratio['country'][deaths_ratio['country'] == 'United Kingdom'] <- 'UK'\ndeaths_ratio['country'][deaths_ratio['country'] == 'United States'] <- 'USA'\ndeaths_ratio['country'][deaths_ratio['country'] == 'Democratic Republic of Congo'] <-\n  'Democratic Republic of the Congo'\n\ncombined_data <- merge(world, deaths_ratio, by.x = \"region\", by.y = \"country\", all.x = TRUE)\n\n## ggplot ----\nsuppressWarnings(ggplot() + geom_map(data = combined_data, map = world, color = 'white',\n         aes(x = long, y = lat, map_id = region, fill = deaths_per_population)) +\n  scale_fill_gradient(low = \"red\", high = \"black\", na.value = 'gray',\n                      labels = scales::label_percent()) +\n  theme_void() + \n  labs(title = \"Confirmed COVID-19 deaths relative to the size of the population\",\n       subtitle = str_glue(\"Around {total_death} Million confirmed COVID-19 deaths worldwid\"),\n       caption = \"Date 04/16/22\",\n       x = '', y = '',\n       fill = \"Mortality Rate\") +\n  scale_x_continuous(breaks = NULL) +\n  scale_y_continuous(breaks = NULL))\n```\n\n::: {.cell-output-display}\n![](04_data_visualization_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}