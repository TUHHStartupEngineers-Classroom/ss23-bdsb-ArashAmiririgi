{
  "hash": "ae57d2a3b7be4228ea67ee4f132a4361",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Joschka Schwarz\"\n---\n\n\n::: callout-note\nYou can delete everything in here and start fresh.\n:::\n\nThis is a `.qmd` file. It is plain text with special features. Any time you write just like this, it will be compiled to normal text in the website. If you put a \\# in front of your text, it will create a top level-header.\n\nTo learn more about Quarto websites visit <https://quarto.org/docs/websites>.\n\n# Text Formatting\n\n*italics* and **bold**\n\nsuperscript^2^ / subscript~2~\n\n~~strikethrough~~\n\n`verbatim code`\n\n> Blockquote\n\n# Headings\n\n## Header 2\n### Header 3\n#### Header 4\n##### Header 5\n###### Header 6\n\n# Links & Images\n\n<https://quarto.org>\n\n[Quarto](https://quarto.org)\n\n![Caption](../../assets/img/elephant.png)    \n\n[![Caption](../../assets/img/elephant.png)](https://quarto.org)\n\n[![Caption](../../assets/img/elephant.png)](https://quarto.org \"An elephant\")\n\n\n# Lists\n\n* unordered list\n    + sub-item 1\n    + sub-item 2\n        - sub-sub-item 1\n        \n*   item 2\n\n    Continued (indent 4 spaces)\n    \n    \n1. ordered list\n2. item 2\n    i) sub-item 1\n         A.  sub-sub-item 1\n         \n(@)  A list whose numbering\n\ncontinues after\n\n(@)  an interruption\n\n# Tables\n\n| Right | Left | Default | Center |\n|------:|:-----|---------|:------:|\n|   12  |  12  |    12   |    12  |\n|  123  |  123 |   123   |   123  |\n|    1  |    1 |     1   |     1  |\n\n# Source Code\n\nUse ``` to delimit blocks of source code:\n\n```\ncode\n```\n\nAdd a language to syntax highlight code blocks:\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_78745102f85d5cf89cad6fe4a83ca938'}\n\n```{.r .cell-code}\n1 + 1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n#> [1] 2\n```\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-2_f6e8e1bca112a7054679dca3031b6157'}\n\n```{.r .cell-code}\ncars\n```\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"speed\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"dist\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"4\",\"2\":\"2\"},{\"1\":\"4\",\"2\":\"10\"},{\"1\":\"7\",\"2\":\"4\"},{\"1\":\"7\",\"2\":\"22\"},{\"1\":\"8\",\"2\":\"16\"},{\"1\":\"9\",\"2\":\"10\"},{\"1\":\"10\",\"2\":\"18\"},{\"1\":\"10\",\"2\":\"26\"},{\"1\":\"10\",\"2\":\"34\"},{\"1\":\"11\",\"2\":\"17\"},{\"1\":\"11\",\"2\":\"28\"},{\"1\":\"12\",\"2\":\"14\"},{\"1\":\"12\",\"2\":\"20\"},{\"1\":\"12\",\"2\":\"24\"},{\"1\":\"12\",\"2\":\"28\"},{\"1\":\"13\",\"2\":\"26\"},{\"1\":\"13\",\"2\":\"34\"},{\"1\":\"13\",\"2\":\"34\"},{\"1\":\"13\",\"2\":\"46\"},{\"1\":\"14\",\"2\":\"26\"},{\"1\":\"14\",\"2\":\"36\"},{\"1\":\"14\",\"2\":\"60\"},{\"1\":\"14\",\"2\":\"80\"},{\"1\":\"15\",\"2\":\"20\"},{\"1\":\"15\",\"2\":\"26\"},{\"1\":\"15\",\"2\":\"54\"},{\"1\":\"16\",\"2\":\"32\"},{\"1\":\"16\",\"2\":\"40\"},{\"1\":\"17\",\"2\":\"32\"},{\"1\":\"17\",\"2\":\"40\"},{\"1\":\"17\",\"2\":\"50\"},{\"1\":\"18\",\"2\":\"42\"},{\"1\":\"18\",\"2\":\"56\"},{\"1\":\"18\",\"2\":\"76\"},{\"1\":\"18\",\"2\":\"84\"},{\"1\":\"19\",\"2\":\"36\"},{\"1\":\"19\",\"2\":\"46\"},{\"1\":\"19\",\"2\":\"68\"},{\"1\":\"20\",\"2\":\"32\"},{\"1\":\"20\",\"2\":\"48\"},{\"1\":\"20\",\"2\":\"52\"},{\"1\":\"20\",\"2\":\"56\"},{\"1\":\"20\",\"2\":\"64\"},{\"1\":\"22\",\"2\":\"66\"},{\"1\":\"23\",\"2\":\"54\"},{\"1\":\"24\",\"2\":\"70\"},{\"1\":\"24\",\"2\":\"92\"},{\"1\":\"24\",\"2\":\"93\"},{\"1\":\"24\",\"2\":\"120\"},{\"1\":\"25\",\"2\":\"85\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-3_c54f7526e0f7f04368360fa7b6e5663a'}\n\n```{.r .cell-code}\nplot(cars)\n```\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n**Sales analysis by state and year:**\n\n**Code:**\n\n\n# 1.0 Load libraries ----\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(stringr)\nlibrary(tibble)\nlibrary(httr)\nlibrary(jsonlite)\nlibrary(purrr)\nlibrary(glue)\nlibrary(xopen)\nlibrary(rmarkdown)\nlibrary(readxl)\n\n# 2.0 Importing Files ----\nbikes <- read_excel('_site/Project/Tidyverse/bikes.xlsx')\nbikeshops <- read_excel('_site/Project/Tidyverse/bikeshops.xlsx')\norderlines <- read_excel('_site/Project/Tidyverse/orderlines.xlsx')\n\n# 3.0 Examining Data ----\nglimpse(orderlines)\n\n# 4.0 Joining Data ----\njoined_data <- left_join(orderlines, bikes,\n  by=c('product.id'='bike.id')) %>% left_join(bikeshops,\n  by=c('customer.id'='bikeshop.id'))\n\n# 5.0 Wrangling Data ----\njoined_data_wragled <- separate(joined_data, col = 'category',\n  into = c('category.1', 'category.2', 'category.3')\n  ,sep = ' - ')\njoined_data_wragled <- joined_data_wragled %>% mutate('total_price' = price * quantity)\njoined_data_wragled <- joined_data_wragled %>% select(-c(...1, gender))\njoined_data_wragled <- joined_data_wragled %>% select(-ends_with('.id'))\njoined_data_wragled <- bind_cols(joined_data_wragled, joined_data %>% select(order.id))\njoined_data_wragled <- joined_data_wragled %>% select(order.id, contains('order'),\n  contains('model'), contains('category'), price, quantity, total_price, everything())\njoined_data_wragled <- joined_data_wragled %>% set_names(names(.) %>% str_replace_all('\\\\.', '_'))\njoined_data_wragled <- joined_data_wragled %>% rename(bikeshop = name)\n\n################################last step is not done\n\n# 6.0 Business Insights ----\n# 6.1 Sales by Year ----\n\n# Step 1 - Manipulate\nsales_by_year <- joined_data_wragled %>% select(order_date, total_price)\nsales_by_year <- sales_by_year %>% mutate(year = year(order_date))\nlibrary(scales)\nsales_by_year <- sales_by_year %>% group_by(year) %>% summarise(sales = sum(total_price))\nsales_by_year <- sales_by_year %>% mutate(sales_text = dollar(sales, big.mark = '.',\n  decimal_mark = ',', prefix = '', suffix = ' €'))\n\n# Step 2 - Visualize\nsales_by_year %>% ggplot(aes(x = year, y = sales)) + \n  geom_col(fill = \"#2DC6D6\") +\n  geom_label(aes(label = sales_text)) + \n  geom_smooth(method = `lm`, se = FALSE) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',\n    decimal_mark = ',', prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by year\", subtitle = \"Upward Trend\",\n  x = \"\", y = \"Revenue\")\n\n# 6.2 Sales by Year and Category 2 ----\n\n# Step 1 - Manipulate\nsales_by_year_cat <- joined_data_wragled %>%\n  select(order_date, total_price, category_1) %>%\n  mutate(year = year(order_date)) %>%\n  group_by(year, category_1) %>% summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  mutate(sales_text = dollar(sales, big.mark = '.',\n    decimal_mark = ',', prefix = '', suffix = ' €'))\n\n# Step 2 - Visualize\nsales_by_year_cat %>% ggplot(aes(x = year, y = sales, fill = category_1)) + \n  geom_col() +\n  facet_wrap(~ category_1) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',\n        decimal_mark = ',', prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by year and main category\",\n        subtitle = \"Each product category has an upward trend\",\n        fill= 'Main category')\n\n# 7.0 Writing Files ----\ninstall.packages(\"writexl\")\nlibrary(\"writexl\")\n\n# 7.1 Excel ----\n# write_xlsx(joined_data_wragled, 'Chapter 2/joined_data_wragled.xlsx')\n\n# 7.2 CSV ----\n# write_csv(joined_data_wragled, 'Chapter 2/joined_data_wragled.csv')\n\n# 7.3 RDS ----\n# write_rds(joined_data_wragled, 'Chapter 2/joined_data_wragled.rds')\n\n# Challenge ----\n# first ----\njoined_data_wragled <- joined_data_wragled %>% separate(col = 'location',\n  into = c('city', 'state'), sep = ', ')\nsales_by_state <- joined_data_wragled %>%\n  group_by(state) %>%  summarise(sales = sum(total_price)) %>%\n  ungroup()\nsales_by_state <- sales_by_state %>% mutate(sales_text = dollar(sales, big.mark = '.',\n  decimal_mark = ',', prefix = '', suffix = ' €'))\n\nsales_by_state %>% ggplot(aes(x = state, y = sales)) + \n  geom_col(fill = \"red\") +\n  geom_label(aes(label = sales_text)) + \n  geom_smooth(method = `lm`, se = FALSE) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',\n                                                    decimal_mark = ',', prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by state\",x = \"\", y = \"Revenue\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n\n# second ----\nsales_by_year_state <- joined_data_wragled %>%\n  select(order_date, total_price, state) %>%\n  mutate(year = year(order_date)) %>%\n  group_by(year, state) %>% summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  mutate(sales_text = dollar(sales, big.mark = '.',\n    decimal_mark = ',', prefix = '', suffix = ' €'))\n\nsales_by_year_state %>% ggplot(aes(x = year, y = sales, fill = state)) + \n  geom_col() +\n  facet_wrap(~ state) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',\n    decimal_mark = ',', prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by year and state\", fill= 'state')```\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}