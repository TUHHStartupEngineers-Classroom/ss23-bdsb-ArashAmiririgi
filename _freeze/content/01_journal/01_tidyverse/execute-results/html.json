{
  "hash": "9f8c2148234d9576fbd5285f98db3173",
  "result": {
    "markdown": "---\ntitle: \"Tidyverse\"\nauthor: \"Arash Amiririgi\"\n---\n\n\n**Sales analysis by state and year:**\n\n\n**Code:**\n\n\n::: {.cell hash='01_tidyverse_cache/html/unnamed-chunk-1_07c2047d839904bc231944387abda40b'}\n\n```{.r .cell-code}\n# Load libraries ----\nlibrary(tidyverse)\nlibrary(rvest)\nlibrary(stringr)\nlibrary(tibble)\nlibrary(rmarkdown)\nlibrary(readxl)\nlibrary(scales)\n\n# Importing Files ----\nbikes <- read_excel('bikes.xlsx')\nbikeshops <- read_excel('bikeshops.xlsx')\norderlines <- read_excel('orderlines.xlsx')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> New names:\n#> • `` -> `...1`\n```\n:::\n\n```{.r .cell-code}\n# Joining Data ----\njoined_data <- left_join(orderlines, bikes,\n  by=c('product.id'='bike.id')) %>% left_join(bikeshops,\n  by=c('customer.id'='bikeshop.id'))\n\n# Wrangling Data ----\njoined_data_wragled <- separate(joined_data, col = 'category',\n  into = c('category.1', 'category.2', 'category.3')\n  ,sep = ' - ')\njoined_data_wragled <- joined_data_wragled %>% mutate('total_price' = price * quantity)\njoined_data_wragled <- joined_data_wragled %>% select(-c(...1, gender))\njoined_data_wragled <- joined_data_wragled %>% select(-ends_with('.id'))\njoined_data_wragled <- bind_cols(joined_data_wragled, joined_data %>% select(order.id))\njoined_data_wragled <- joined_data_wragled %>% select(order.id, contains('order'),\n  contains('model'), contains('category'), price, quantity, total_price, everything())\njoined_data_wragled <- joined_data_wragled %>% set_names(names(.) %>% str_replace_all('\\\\.', '_'))\njoined_data_wragled <- joined_data_wragled %>% rename(bikeshop = name)\n\n# analysis by state ----\njoined_data_wragled <- joined_data_wragled %>% separate(col = 'location',\n  into = c('city', 'state'), sep = ', ')\nsales_by_state <- joined_data_wragled %>%\n  group_by(state) %>%  summarise(sales = sum(total_price)) %>%\n  ungroup()\nsales_by_state <- sales_by_state %>% mutate('sales_text' = dollar(sales, big.mark = '.',\n  prefix = '', suffix = ' €'))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: There was 1 warning in `mutate()`.\n#> ℹ In argument: `sales_text = dollar(sales, big.mark = \".\", prefix = \"\", suffix\n#>   = \" €\")`.\n#> Caused by warning in `prettyNum()`:\n#> ! 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n```\n:::\n\n```{.r .cell-code}\nsales_by_state %>% ggplot(aes(x = state, y = sales)) + \n  geom_col(fill = \"red\") +\n  geom_label(aes(label = sales_text)) + \n  geom_smooth(method = `lm`, se = FALSE) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.', prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by state\",x = \"\", y = \"Revenue\") +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# analysis by year and state ----\nsales_by_year_state <- joined_data_wragled %>%\n  select(order_date, total_price, state) %>%\n  mutate('year' = year(order_date)) %>%\n  group_by(year, state) %>% summarise(sales = sum(total_price)) %>%\n  ungroup() %>%\n  mutate('sales_text' = dollar(sales, big.mark = '.', prefix = '', suffix = ' €'))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> `summarise()` has grouped output by 'year'. You can override using the\n#> `.groups` argument.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning: There was 1 warning in `mutate()`.\n#> ℹ In argument: `sales_text = dollar(sales, big.mark = \".\", prefix = \"\", suffix\n#>   = \" €\")`.\n#> Caused by warning in `prettyNum()`:\n#> ! 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n```\n:::\n\n```{.r .cell-code}\nsales_by_year_state %>% ggplot(aes(x = year, y = sales, fill = state)) + \n  geom_col() +\n  facet_wrap(~ state) +\n  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',\n    prefix = '', suffix = ' €')) +\n  labs( title = \"Revenue by year and state\", fill= 'state')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n\n#> Warning in prettyNum(.Internal(format(x, trim, digits, nsmall, width, 3L, :\n#> 'big.mark' and 'decimal.mark' are both '.', which could be confusing\n```\n:::\n\n::: {.cell-output-display}\n![](01_tidyverse_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}