---
title: "My Lab Journal"
subtitle: "Business Data Science Basics"
author: "Arash Amiririgi"
---

![](assets/logo/TIE_logo.svg){width=80% fig-align="center"}

This is a template example for lab journaling. Students in the data science courses at the Institute of Entrepreneurship will use this template to learn R for business analytics. Students can replace this text as they wish.

## How to use

1. Accept the assignment and get your own github repo.

2. Blog/journal what you are doing in R, by editing the `.qmd` files. 

3. See the links page for lots of helpful links on learning R.

4. Change everything to make it your own.

5. Make sure to render you website everytime before you want to upload changes





library(tidyverse)
library(readr)
library(scales)
joined_data_wragled <- read_rds('joined_data_wragled.rds')

# first ----
joined_data_wragled <- joined_data_wragled %>% separate(col = 'location',
  into = c('city', 'state'), sep = ', ')
sales_by_state <- joined_data_wragled %>%
  group_by(state) %>%  summarise(sales = sum(total_price)) %>%
  ungroup()
sales_by_state <- sales_by_state %>% mutate(sales_text = dollar(sales, big.mark = '.',
  decimal_mark = ',', prefix = '', suffix = ' €'))

sales_by_state %>% ggplot(aes(x = state, y = sales)) + 
  geom_col(fill = "red") +
  geom_label(aes(label = sales_text)) + 
  geom_smooth(method = `lm`, se = FALSE) +
  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',
                                                    decimal_mark = ',', prefix = '', suffix = ' €')) +
  labs( title = "Revenue by state",x = "", y = "Revenue") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

# second ----
sales_by_year_state <- joined_data_wragled %>%
  select(order_date, total_price, state) %>%
  mutate(year = year(order_date)) %>%
  group_by(year, state) %>% summarise(sales = sum(total_price)) %>%
  ungroup() %>%
  mutate(sales_text = dollar(sales, big.mark = '.',
    decimal_mark = ',', prefix = '', suffix = ' €'))

sales_by_year_state %>% ggplot(aes(x = year, y = sales, fill = state)) + 
  geom_col() +
  facet_wrap(~ state) +
  scale_y_continuous(labels = scales::dollar_format(big.mark = '.',
    decimal_mark = ',', prefix = '', suffix = ' €')) +
  labs( title = "Revenue by year and state",
    fill= 'state')


